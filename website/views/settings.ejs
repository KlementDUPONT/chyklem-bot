<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Panel - <%= guild.name %></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- PALETTE MEE6-LIKE --- */
        :root { 
            --bg-body: #18191c; 
            --bg-sidebar: #202225; 
            --bg-card: #2f3136; 
            --text-main: #ffffff; 
            --text-muted: #b9bbbe; 
            --accent: #5865F2; 
            --success: #3ba55d;
            --hover: #40444b;
        }

        body { background: var(--bg-body); color: var(--text-main); font-family: 'Segoe UI', sans-serif; height: 100vh; overflow: hidden; }
        
        .wrapper { display: flex; height: 100%; }
        
        /* SIDEBAR */
        .sidebar { width: 280px; background: var(--bg-sidebar); padding: 20px; display: flex; flex-direction: column; border-right: 1px solid #202225; overflow-y: auto; }
        .server-header { display: flex; align-items: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid #2f3136; }
        .server-icon { width: 48px; height: 48px; border-radius: 50%; margin-right: 15px; object-fit: cover; border: 2px solid var(--accent); }
        .nav-category { font-size: 0.75rem; text-transform: uppercase; color: #8e9297; margin: 25px 0 10px 10px; font-weight: bold; letter-spacing: 0.5px; }
        
        .nav-btn { display: flex; align-items: center; padding: 10px 15px; color: var(--text-muted); text-decoration: none; border-radius: 5px; margin-bottom: 5px; transition: 0.2s; cursor: pointer; font-weight: 500; }
        .nav-btn:hover, .nav-btn.active { background: var(--hover); color: white; }
        .nav-btn i { width: 25px; text-align: center; margin-right: 10px; font-size: 1.1em; }
        .nav-btn.active { background: var(--accent); }

        /* CONTENT AREA */
        .content { flex: 1; padding: 40px 60px; overflow-y: auto; position: relative; background: var(--bg-body); }
        h2 { font-weight: 700; margin-bottom: 30px; border-bottom: 2px solid #2f3136; padding-bottom: 15px; }

        /* GRILLE DE MODULES (STYLE MEE6) */
        .modules-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-bottom: 40px; }
        
        .module-card { 
            background: var(--bg-card); 
            border-radius: 12px; 
            padding: 20px; 
            transition: transform 0.2s, box-shadow 0.2s; 
            cursor: pointer; 
            border: 1px solid transparent;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            height: 200px;
        }
        .module-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.2); border-color: var(--accent); }
        
        .card-header { display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 15px; }
        .card-icon { 
            width: 50px; height: 50px; 
            border-radius: 10px; 
            display: flex; align-items: center; justify-content: center; 
            font-size: 24px; color: white; 
            background: linear-gradient(135deg, var(--accent), #4752c4);
        }
        .status-badge { font-size: 0.8rem; padding: 3px 10px; border-radius: 20px; font-weight: bold; background: #202225; color: #72767d; }
        .status-badge.active { background: rgba(59, 165, 93, 0.1); color: var(--success); }

        .card-title { font-size: 1.2rem; font-weight: bold; margin-bottom: 5px; }
        .card-desc { font-size: 0.9rem; color: var(--text-muted); line-height: 1.4; }
        .card-footer { margin-top: auto; padding-top: 15px; border-top: 1px solid #36393f; display: flex; justify-content: flex-end; }
        .btn-config { background: #202225; color: white; border: none; padding: 5px 15px; border-radius: 5px; font-size: 0.9rem; transition: 0.2s; }
        .module-card:hover .btn-config { background: var(--accent); }

        /* CONFIGURATION BOXES */
        .module-section { display: none; animation: fadeIn 0.3s; }
        .module-section.active { display: block; }
        .config-box { background: var(--bg-card); padding: 30px; border-radius: 12px; margin-bottom: 25px; border: 1px solid #202225; }
        
        /* FORM ELEMENTS */
        .form-control, .form-select { background: #202225; border: 1px solid #202225; color: white; padding: 12px; border-radius: 8px; }
        .form-control:focus, .form-select:focus { background: #202225; color: white; border-color: var(--accent); box-shadow: none; }
        .form-label { font-weight: 600; color: #b9bbbe; margin-bottom: 10px; }
        
        /* SAVE BAR */
        .save-bar { position: absolute; bottom: -100px; left: 50%; transform: translateX(-50%); background: #111; padding: 15px 40px; border-radius: 50px; display: flex; align-items: center; gap: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 999; border: 1px solid #333; }
        .save-bar.show { bottom: 40px; }

        /* TABLES */
        .cmd-table { width: 100%; border-collapse: separate; border-spacing: 0 10px; }
        .cmd-table th { color: #8e9297; padding: 10px; font-size: 0.9rem; text-transform: uppercase; }
        .cmd-table td { background: #202225; padding: 15px; first-child: border-radius: 8px 0 0 8px; last-child: border-radius: 0 8px 8px 0; }
        .cmd-table tr:hover td { background: #292b2f; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .preview-welcome { height: 180px; background-size: cover; background-position: center; display: flex; align-items: center; justify-content: center; border-radius: 12px; border: 2px solid var(--accent); position: relative; overflow: hidden; }
        .preview-overlay { background: rgba(0,0,0,0.5); padding: 15px 30px; border-radius: 10px; backdrop-filter: blur(2px); }
        .preview-text { font-size: 24px; font-weight: bold; text-shadow: 0 2px 5px rgba(0,0,0,0.8); }
    </style>
</head>
<body>

    <div class="wrapper">
        <div class="sidebar">
            <div class="server-header">
                <% if (guild.icon) { %>
                    <img class="server-icon" src="https://cdn.discordapp.com/icons/<%= guild.id %>/<%= guild.icon %>.png">
                <% } else { %>
                    <div class="server-icon bg-primary d-flex align-items-center justify-content-center text-white fw-bold"><%= guild.name.charAt(0) %></div>
                <% } %>
                <div class="fw-bold text-truncate"><%= guild.name %></div>
            </div>

            <div class="nav-btn active" onclick="showTab('overview', this)"><i class="fas fa-th-large"></i> Tableau de bord</div>
            
            <div class="nav-category">Gestion</div>
            <div class="nav-btn" onclick="showTab('moderation', this)"><i class="fas fa-gavel"></i> Mod√©ration</div>
            <div class="nav-btn" onclick="showTab('customcmds', this)"><i class="fas fa-terminal"></i> Commandes Perso</div>
            <div class="nav-btn" onclick="showTab('economy', this)"><i class="fas fa-coins"></i> √âconomie</div>
            
            <div class="nav-category">Utilitaires</div>
            <div class="nav-btn" onclick="showTab('welcome', this)"><i class="fas fa-door-open"></i> Bienvenue</div>
            <div class="nav-btn" onclick="showTab('social', this)"><i class="fas fa-gift"></i> Anniversaires</div>
            <div class="nav-btn" onclick="showTab('levels', this)"><i class="fas fa-trophy"></i> Niveaux</div>
            <div class="nav-btn" onclick="showTab('security', this)"><i class="fas fa-shield-alt"></i> S√©curit√©</div>
            <div class="nav-btn" onclick="showTab('logs', this)"><i class="fas fa-list-alt"></i> Logs & Historique</div>

            <a href="/dashboard" class="nav-btn mt-auto text-danger"><i class="fas fa-sign-out-alt"></i> D√©connexion</a>
        </div>

        <div class="content">
            <% if (success) { %>
                <div class="alert alert-success position-fixed top-0 end-0 m-4" style="z-index: 1050; border-radius: 10px;" id="successAlert">
                    <i class="fas fa-check-circle me-2"></i> Configuration sauvegard√©e !
                </div>
                <script>setTimeout(() => document.getElementById('successAlert').style.display = 'none', 3000);</script>
            <% } %>

            <form action="/settings/<%= guild.id %>" method="POST" id="settingsForm">

                <div id="overview" class="module-section active">
                    <h2>Tableau de Bord</h2>
                    
                    <div class="nav-category mt-0">Modules Essentiels</div>
                    <div class="modules-grid">
                        
                        <div class="module-card" onclick="openTab('welcome')">
                            <div>
                                <div class="card-header">
                                    <div class="card-icon" style="background: linear-gradient(135deg, #FF9800, #F57C00);"><i class="fas fa-door-open"></i></div>
                                    <span class="status-badge <%= settings.welcome_channel_id ? 'active' : '' %>">
                                        <%= settings.welcome_channel_id ? 'ACTIF' : 'INACTIF' %>
                                    </span>
                                </div>
                                <div class="card-title">Bienvenue</div>
                                <div class="card-desc">Accueille les nouveaux membres avec une belle image personnalis√©e.</div>
                            </div>
                            <div class="card-footer"><button class="btn-config" type="button">Configurer</button></div>
                        </div>

                        <div class="module-card" onclick="openTab('moderation')">
                            <div>
                                <div class="card-header">
                                    <div class="card-icon" style="background: linear-gradient(135deg, #F44336, #D32F2F);"><i class="fas fa-gavel"></i></div>
                                    <span class="status-badge active">ACTIF</span>
                                </div>
                                <div class="card-title">Mod√©ration</div>
                                <div class="card-desc">G√®re les logs, l'auto-mod√©ration et les sanctions.</div>
                            </div>
                            <div class="card-footer"><button class="btn-config" type="button">Configurer</button></div>
                        </div>

                        <div class="module-card" onclick="openTab('levels')">
                            <div>
                                <div class="card-header">
                                    <div class="card-icon" style="background: linear-gradient(135deg, #2196F3, #1976D2);"><i class="fas fa-trophy"></i></div>
                                    <span class="status-badge <%= settings.levels_enabled ? 'active' : '' %>">
                                        <%= settings.levels_enabled ? 'ACTIF' : 'INACTIF' %>
                                    </span>
                                </div>
                                <div class="card-title">Niveaux</div>
                                <div class="card-desc">Syst√®me d'XP et r√©compenses de r√¥les automatique.</div>
                            </div>
                            <div class="card-footer"><button class="btn-config" type="button">Configurer</button></div>
                        </div>

                    </div>

                    <div class="nav-category">Gestion & Utilitaires</div>
                    <div class="modules-grid">

                        <div class="module-card" onclick="openTab('economy')">
                            <div>
                                <div class="card-header">
                                    <div class="card-icon" style="background: linear-gradient(135deg, #FFEB3B, #FBC02D); color: #333;"><i class="fas fa-coins"></i></div>
                                    <span class="status-badge active">ACTIF</span>
                                </div>
                                <div class="card-title">√âconomie</div>
                                <div class="card-desc">Syst√®me mon√©taire, magasins et jeux d'argent.</div>
                            </div>
                            <div class="card-footer"><button class="btn-config" type="button">Configurer</button></div>
                        </div>

                        <div class="module-card" onclick="openTab('social')">
                            <div>
                                <div class="card-header">
                                    <div class="card-icon" style="background: linear-gradient(135deg, #E91E63, #C2185B);"><i class="fas fa-birthday-cake"></i></div>
                                    <span class="status-badge <%= settings.birthday_channel_id ? 'active' : '' %>">
                                        <%= settings.birthday_channel_id ? 'ACTIF' : 'INACTIF' %>
                                    </span>
                                </div>
                                <div class="card-title">Anniversaires</div>
                                <div class="card-desc">Souhaite automatiquement les anniversaires.</div>
                            </div>
                            <div class="card-footer"><button class="btn-config" type="button">Configurer</button></div>
                        </div>

                        <div class="module-card" onclick="openTab('customcmds')">
                            <div>
                                <div class="card-header">
                                    <div class="card-icon" style="background: linear-gradient(135deg, #9C27B0, #7B1FA2);"><i class="fas fa-terminal"></i></div>
                                    <span class="status-badge active">ACTIF</span>
                                </div>
                                <div class="card-title">Commandes Perso</div>
                                <div class="card-desc">Cr√©e tes propres commandes textuelles simples.</div>
                            </div>
                            <div class="card-footer"><button class="btn-config" type="button">Configurer</button></div>
                        </div>

                    </div>
                </div>

                <div id="social" class="module-section">
                    <h2><i class="fas fa-gift me-2 text-primary"></i> Social & Anniversaires</h2>
                    <div class="config-box">
                        <label class="form-label">Salon des Anniversaires</label>
                        <select name="birthday_channel_id" class="form-select">
                            <option value="">üö´ D√©sactiv√©</option>
                            <% channels.forEach(c => { if(c.type===0){ %>
                                <option value="<%= c.id %>" <%= settings.birthday_channel_id===c.id?'selected':'' %>>#<%= c.name %></option>
                            <% }}) %>
                        </select>
                        <div class="form-text text-muted mt-2">Le bot y souhaitera joyeux anniversaire le matin √† 08h00.</div>
                    </div>

                    <div class="config-box">
                        <h5>üèÜ Top Interactions (C√¢lins/Bisous)</h5>
                        <table class="cmd-table mt-3">
                            <thead><tr><th>De</th><th>Vers</th><th>Type</th><th>Total</th></tr></thead>
                            <tbody>
                                <% if (actionTop.length > 0) { %>
                                    <% actionTop.forEach(a => { %>
                                        <tr>
                                            <td style="color:var(--text-muted)"><%= a.user_from %></td>
                                            <td><%= a.user_to %></td>
                                            <td><span class="badge bg-secondary"><%= a.action_type %></span></td>
                                            <td class="fw-bold text-success"><%= a.count %></td>
                                        </tr>
                                    <% }) %>
                                <% } else { %>
                                    <tr><td colspan="4" class="text-muted">Aucune interaction pour le moment.</td></tr>
                                <% } %>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="welcome" class="module-section">
                    <h2><i class="fas fa-door-open me-2 text-warning"></i> Bienvenue</h2>
                    <div class="config-box">
                        <div class="row">
                            <div class="col-md-6">
                                <label class="form-label">Salon d'arriv√©e</label>
                                <select name="welcome_channel_id" class="form-select mb-3">
                                    <option value="">üö´ D√©sactiv√©</option>
                                    <% channels.forEach(c => { if(c.type===0){ %>
                                        <option value="<%= c.id %>" <%= settings.welcome_channel_id===c.id?'selected':'' %>>#<%= c.name %></option>
                                    <% }}) %>
                                </select>
                                <label class="form-label">R√¥le Auto</label>
                                <select name="autorole_id" class="form-select mb-3">
                                    <option value="">üö´ Aucun</option>
                                    <% roles.forEach(r => { if(r.name!=='@everyone' && !r.managed){ %>
                                        <option value="<%= r.id %>" <%= settings.autorole_id===r.id?'selected':'' %>>@<%= r.name %></option>
                                    <% }}) %>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Aper√ßu</label>
                                <div class="preview-welcome mb-3" id="previewBox" style="background-image: url('<%= settings.welcome_bg || "https://i.imgur.com/vH1W4Qc.jpeg" %>');">
                                    <div class="preview-overlay">
                                        <div class="preview-text" id="previewText" style="color: <%= settings.welcome_color || "#ffffff" %>;">BIENVENUE</div>
                                    </div>
                                </div>
                                <input type="text" name="welcome_bg" id="bgInput" class="form-control mb-2" placeholder="URL Image" value="<%= settings.welcome_bg %>">
                                <input type="color" name="welcome_color" id="colorInput" class="form-control form-control-color w-100" value="<%= settings.welcome_color %>">
                            </div>
                        </div>
                    </div>
                </div>

                <div id="levels" class="module-section">
                    <h2><i class="fas fa-trophy me-2 text-info"></i> Niveaux</h2>
                    <div class="config-box d-flex justify-content-between align-items-center">
                        <div><h5>Activer l'XP</h5><div class="text-muted">Les membres gagnent de l'XP en discutant.</div></div>
                        <div class="form-check form-switch"><input class="form-check-input" type="checkbox" name="levels_enabled" <%= settings.levels_enabled ? 'checked' : '' %>></div>
                    </div>
                    <div class="config-box">
                        <label class="form-label">Message Level Up</label>
                        <input type="text" name="level_up_message" class="form-control" value="<%= settings.level_up_message %>">
                        <div class="form-text text-muted mt-2">Variables : {user} = Mention, {level} = Niveau.</div>
                    </div>
                </div>

                <div id="moderation" class="module-section">
                    <h2><i class="fas fa-gavel me-2 text-danger"></i> Mod√©ration</h2>
                    <div class="config-box">
                        <label class="form-label">Salon de Logs</label>
                        <select name="log_channel_id" class="form-select">
                            <option value="">üö´ D√©sactiv√©</option>
                            <% channels.forEach(c => { if(c.type===0){ %>
                                <option value="<%= c.id %>" <%= settings.log_channel_id===c.id?'selected':'' %>>#<%= c.name %></option>
                            <% }}) %>
                        </select>
                    </div>
                    <div class="config-box">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div><h5 class="text-warning">Auto-Mod</h5><div class="text-muted">Supprime automatiquement les mots interdits.</div></div>
                            <div class="form-check form-switch"><input class="form-check-input" type="checkbox" name="automod_enabled" <%= settings.automod_enabled ? 'checked' : '' %>></div>
                        </div>
                        <label class="form-label">Mots interdits (s√©par√©s par virgule)</label>
                        <textarea name="automod_words" class="form-control" rows="3"><%= settings.automod_words || '' %></textarea>
                    </div>
                </div>

                <div id="security" class="module-section">
                    <h2><i class="fas fa-shield-alt me-2 text-success"></i> S√©curit√©</h2>
                    <div class="config-box d-flex justify-content-between align-items-center">
                        <div><h5 class="text-danger">Anti-Raid</h5><div class="text-muted">Kick automatique des comptes r√©cents.</div></div>
                        <div class="form-check form-switch"><input class="form-check-input" type="checkbox" name="antiraid_enabled" <%= settings.antiraid_enabled ? 'checked' : '' %>></div>
                    </div>
                    <div class="config-box">
                        <label class="form-label">√Çge minimum du compte (jours)</label>
                        <input type="number" name="antiraid_days" class="form-control" value="<%= settings.antiraid_account_age_days %>">
                    </div>
                </div>

                <div class="save-bar" id="saveBar">
                    <span class="text-white fw-bold"><i class="fas fa-exclamation-circle text-warning me-2"></i> Modifications non enregistr√©es</span>
                    <button type="button" class="btn btn-outline-light btn-sm ms-3" onclick="resetForm()">Annuler</button>
                    <button type="submit" class="btn btn-success btn-sm fw-bold px-4 ms-2">Enregistrer</button>
                </div>

            </form>

            <div id="logs" class="module-section">
                <h2><i class="fas fa-history me-2"></i> Historique</h2>
                <div class="config-box">
                    <h5>üìú Derni√®res Sanctions</h5>
                    <table class="cmd-table mt-3">
                        <thead><tr><th>Date</th><th>Utilisateur</th><th>Mod√©rateur</th><th>Raison</th></tr></thead>
                        <tbody>
                            <% if (warnings.length > 0) { %>
                                <% warnings.forEach(w => { %>
                                    <tr>
                                        <td class="text-muted"><%= new Date(w.date).toLocaleDateString() %></td>
                                        <td><%= w.user_id %></td>
                                        <td><%= w.moderator_id %></td>
                                        <td><%= w.reason %></td>
                                    </tr>
                                <% }) %>
                            <% } else { %>
                                <tr><td colspan="4" class="text-muted text-center py-4">Aucune sanction.</td></tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="customcmds" class="module-section">
                <h2><i class="fas fa-terminal me-2"></i> Commandes Personnalis√©es</h2>
                <div class="config-box">
                    <form action="/settings/<%= guild.id %>/commands/add" method="POST" class="row g-3 align-items-end mt-2">
                        <div class="col-md-4"><label class="form-label">D√©clencheur</label><input type="text" name="trigger" class="form-control" placeholder="ex: !insta" required></div>
                        <div class="col-md-6"><label class="form-label">R√©ponse</label><input type="text" name="response" class="form-control" placeholder="..." required></div>
                        <div class="col-md-2"><button type="submit" class="btn btn-primary w-100"><i class="fas fa-plus"></i></button></div>
                    </form>
                </div>
                <div class="config-box p-0 overflow-hidden">
                    <table class="cmd-table">
                        <% if (customCommands.length > 0) { %>
                            <% customCommands.forEach(cmd => { %>
                                <tr>
                                    <td class="text-info fw-bold"><%= cmd.trigger_word %></td>
                                    <td class="text-muted"><%= cmd.response_text %></td>
                                    <td style="text-align: right;">
                                        <form action="/settings/<%= guild.id %>/commands/delete" method="POST" style="display:inline;">
                                            <input type="hidden" name="command_id" value="<%= cmd.id %>">
                                            <button type="submit" class="btn btn-danger btn-sm"><i class="fas fa-trash"></i></button>
                                        </form>
                                    </td>
                                </tr>
                            <% }) %>
                        <% } else { %>
                            <tr><td colspan="3" class="text-center py-3 text-muted">Aucune commande.</td></tr>
                        <% } %>
                    </table>
                </div>
            </div>

            <div id="economy" class="module-section">
                <h2><i class="fas fa-coins me-2 text-warning"></i> √âconomie</h2>
                <div class="config-box">
                    <h5>üèÜ Top 5 Richesse</h5>
                    <table class="cmd-table">
                        <% if (economyTop.length > 0) { %>
                            <% economyTop.forEach(eco => { %>
                                <tr>
                                    <td><%= eco.user_id %></td>
                                    <td class="text-success fw-bold"><%= eco.money %> $</td>
                                </tr>
                            <% }) %>
                        <% } else { %>
                            <tr><td colspan="2" class="text-muted text-center py-3">Personne n'a d'argent...</td></tr>
                        <% } %>
                    </table>
                </div>
                <div class="config-box">
                    <h5>üëÆ Gestion Admin</h5>
                    <form action="/settings/<%= guild.id %>/economy/update" method="POST" class="row g-3 align-items-end mt-2">
                        <div class="col-md-4"><label class="form-label">ID User</label><input type="text" name="user_id" class="form-control" required></div>
                        <div class="col-md-3"><select name="action" class="form-select"><option value="add">Ajouter</option><option value="remove">Retirer</option><option value="set">D√©finir</option></select></div>
                        <div class="col-md-3"><input type="number" name="amount" class="form-control" required></div>
                        <div class="col-md-2"><button type="submit" class="btn btn-warning w-100"><i class="fas fa-check"></i></button></div>
                    </form>
                </div>
            </div>

        </div>
    </div>

    <script>
        function showTab(tabId, btn) {
            document.querySelectorAll('.module-section').forEach(el => el.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            
            // Mise √† jour Sidebar
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
            if(btn) btn.classList.add('active');
        }

        // Fonction pour ouvrir un onglet depuis une carte (Module Card)
        function openTab(tabId) {
            showTab(tabId);
            // Trouver le bouton sidebar correspondant pour le mettre en surbrillance
            const sidebarBtn = document.querySelector(`.nav-btn[onclick="showTab('${tabId}', this)"]`);
            if(sidebarBtn) {
                document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
                sidebarBtn.classList.add('active');
            }
        }

        const bgInput = document.getElementById('bgInput');
        const colorInput = document.getElementById('colorInput');
        const previewBox = document.getElementById('previewBox');
        const previewText = document.getElementById('previewText');
        function updatePreview() {
            if(bgInput.value) previewBox.style.backgroundImage = `url('${bgInput.value}')`;
            previewText.style.color = colorInput.value;
        }
        bgInput.addEventListener('input', updatePreview);
        colorInput.addEventListener('input', updatePreview);

        const settingsForm = document.getElementById('settingsForm');
        const saveBar = document.getElementById('saveBar');
        settingsForm.addEventListener('change', () => saveBar.classList.add('show'));
        function resetForm() { window.location.reload(); }
    </script>
</body>
</html>